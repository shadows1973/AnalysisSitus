<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01//EN" "http://www.w3.org/TR/html4/strict.dtd">
<html>
 <head>
  <meta http-equiv="Content-Type" content="text/html; charset=utf-8">
  <title>Analysis Situs: writing Tcl plugins</title>
  <link rel="shortcut icon" type="image/png" href="../imgs/favicon.png"/>
  <link rel="stylesheet" type="text/css" href="../css/situ-main-style.css">

  <!-- [begin] Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-112292727-2"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-112292727-2');
  </script>
  <!-- [end] Google Analytics -->

  <!--
     Quick navigation script. Use a div with "toc-panel" class having a
     nested div with "toc" id to place the navigation panel.
    -->
    <script src="../js/jquery-3.5.1.min.js"></script>
    <script src="../js/toc.js"></script>
 </head>
<body>

<a name="top"></a> <!-- anchor for 'back to top' link -->
<table width="100%"><tr><td>
<table align="center" border="0" cellpadding="0" cellspacing="0" width="100%">
<tr>
  <td align="left" class="header">
    <span class="header-logo"><a href="../index.html" class="header-href">Analysis&nbsp;Situs</a></span>
    &nbsp;
    ./<a class="header-href" href="../features.html">features</a>/writing plugins
  </td>
</tr>
</table>
<table align="center" border="0" cellpadding="0" cellspacing="0" width="100%">
<tr>
  <td class="header-menu"><a href='http://quaoar.su/blog/page/analysis-situs'>Download</a></td>
  <td class="header-menu"><a href="../features.html">Features</a></td>
  <td class="header-menu"><a href="https://gitlab.com/ssv/AnalysisSitus">Source code</a></td>
  <td class="header-menu"><a href="../references.html">References</a></td>
  <td class="header-menu"><a href="http://quaoar.su/blog/contact">Ask for support</a></td>
</tr>
</table>
</td></tr></table>

<h1 id="toc-plugin-main">Write your own plugin</h1>

<div class="toc-panel"><div id="toc"></div></div>

<p>
  Analysis Situs allows for extensions via Tcl plugins. On startup, it checks the contents of <span class="code-inline">asi-plugins</span> directory located in the installation directory of the software. Analysis Situs attempts to load all dynamic libraries it finds in that directory. For being a valid plugin, a dynamic library should satisfy specific rules. Analysis Situs tries to call a function named <span class="code-inline">PLUGINFACTORY</span>. If no such function exists, the corresponding candidate library is skipped with an error message.
</p>

<h2 id="toc-plugin-main-why">Why plugins?</h2>

<p>
  Analysis Situs is an open-source software, but you are not obliged to release your derived works under the open source conditions (because we use the <a href="../license.html">BSD license</a>). Therefore, you might want to:
</p>

<ol>
  <li>Purchase one of the commercial add-ons we are developing on top of Analysis Situs.</li>
  <li>Write your own code to customize or enrich Analysis Situs to better fit your needs.</li>
</ol>

<p>
  For both scenarios, plugins are the answer. You can use the native UI workbench but feed it with your own commands. Or you can add our native commercial addons to the workbench to unlock algorithms which are not distributed under the open source conditions.
</p>

<h2 id="toc-plugin-main-code-arch">Code architecture</h2>

<p>
  There is a best practice we encourage you to follow when extending Analysis Situs. Let's imagine you are going to develop a library of your "know-how" algorithms named <span class="code-inline">MyAlgo</span>. It is a good idea to have two libraries though:
</p>

<ol>
  <li><span class="code-inline">MyAlgo</span> for the algorithms.</li>
  <li><span class="code-inline">MyAlgoCmd</span> for the Tcl bindings.</li>
</ol>

<p>
  Having Tcl bindings is not necessary, but it would allow for running your algorithms from within the UI workbench of Analysis Situs.
</p>

<h1 id="toc-plugin-troubleshooting">Troubleshooting</h1>

<h2 id="toc-plugin-troubleshooting-1">Plugin does not load</h2>

<p>
  If your plugin does not load, do the following:
</p>

<ol>
  <li>Check that <span class="code-inline">asi-plugins</span> exists.</li>
  <li>Check that you have all dependencies in your PATH variable.</li>
</ol>

<p>
  For debugging the missing runtime libs on Windows, you may want to use the <a href="https://www.dependencywalker.com/">depends.exe</a> utility. To ensure that you have your development environment configured before running the Dependency Walker, consider launching it right from within IDE:
</p>

<div align="center">
  <img src="../imgs/asi-plugins-depends-exe.png"/>
</div>

<p>
  Among the tons of irrelevant errors, you will be able to find a missing runtime dependency:
</p>

<div align="center">
  <img src="../imgs/asi-plugins-depends-exe2.png"/>
</div>

<p>
  Just keep in mind that your dynamic library may fail to load not because of itself, but because it has its own missing dependency.
</p>

<br/>
<table class="footer" cellpadding="0" cellspacing="0" width="100%">
<tr>
  <td>
    Copyright &copy; Analysis&nbsp;Situs 2020-present &nbsp; | &nbsp; <a class="footer-href" href="#top">^^^</a>  &nbsp; | &nbsp; <a href="http://quaoar.su/blog/contact" class="footer-href">contact us</a> 
  </td>
</tr>
</table>

</body>
</html>
